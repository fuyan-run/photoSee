!function(t){t.fn.extend({photoSeeAll:function(e){function i(){c=l.width,u=l.height,c>f&&(c=f,u=c/g),u>w&&(u=w,c=u*g),c-=20,u-=20,p.css({height:Math.floor(u),width:Math.floor(c),left:Math.floor((f-c)/2),top:Math.floor((w-u)/2)})}function n(){var t=c,e=u,i=(f-t)/2,n=(w-e)/2;p.css({width:t,height:e,left:i,top:n})}function o(e){var i=t("#showTip");i.text(""+e).fadeIn(),clearTimeout(l.showTimer),l.showTimer=setTimeout(function(){i.fadeOut()},1e3)}function r(e){this.dragFlag=!1,this.firstPint=null,this.secondPint=null,this.scale=0,this.newW=0,this.newH=0,this.defaluts={el:null,startFn:null,endFn:null,moveFn:null},this.opt=t.extend(this.defaluts,e),this.oInit()}function a(t){var e=parseInt(t.wheelDelta||-t.detail);e>0?s():h(),t.preventDefault()}function s(){c*=1+d.ratio,u*=1+d.ratio,c>16*l.width?(c=16*l.width,u=c/g):c>.9*l.width&&c<1.1*l.width&&(c=l.width,u=c/g),o(parseInt(c/l.width*100)+"%"),n()}function h(){c*=1-d.ratio,u*=1-d.ratio,c<.05*l.width?(c=.05*l.width,u=c/g):c>.9*l.width&&c<1.1*l.width&&(c=l.width,u=c/g),o(parseInt(c/l.width*100)+"%"),n()}var d={ratio:.2,template:{IMAGE:"<img id='img' ondragstart='return false;' style='position: absolute; top: 0; left: 0;' src='"+e.src+"' />"},showTimer:null},l=t.extend({},d,e);t(".photoSee").append(l.template.IMAGE),t("#X > i").on("click",function(){var e=window.parent||window.top,i=e.document.getElementById("seeMore");t(i).remove()});var c,u,f=window.innerWidth,w=window.innerHeight,p=t("#img"),g=l.width/l.height;if(i(),"ontouchstart"in window){var m,v,F,I,M;r.prototype.oInit=function(){var t=this;return this.opt.el?void this.Move(t):void alert("没有挂载点")},r.prototype.Move=function(t){function e(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)}var i=this;document.addEventListener("touchstart",function(e){e.touches.length>=2?(i.firstPoint=e.touches,i.dragFlag=!0):(m=e.touches[0].pageX,v=e.touches[0].pageY,I=p.position().left,M=p.position().top,imgW=p.width(),imgH=p.height(),F=!0),t.opt.startFn&&t.opt.startFn()}),document.addEventListener("touchmove",function(t){if(t.preventDefault(),t.touches.length>=2&&i.dragFlag){i.secondPint=t.touches;var n=e(i.secondPint[0],i.secondPint[1])/e(i.firstPoint[0],i.firstPoint[1]);i.scale=n,i.newW=c*i.scale,i.newH=i.newW/g,p.css({width:i.newW,height:i.newH})}else if(F){var o=t.touches[0].pageX,r=t.touches[0].pageY,a=o-m+I,s=r-v+M;p.css({left:a}),p.css({top:s})}i.opt.moveFn&&i.opt.moveFn()},!1),document.addEventListener("touchend",function(){i.dragFlag&&(u=i.newH,c=i.newW,w>u&&f>c&&n(),o(parseInt(c/l.width*100)+"%"),i.dragFlag=!1,F=!1),i.opt.endFn&&i.opt.endFn()},!1)};{new r({el:p,startFn:function(){},moveFn:function(){}})}}else{var S=navigator.userAgent.indexOf("Firefox")>-1,W=S?"DOMMouseScroll":"mousewheel";document.addEventListener(W,function(t){a(t)},!1);var m,v,F,I,M;p.on("mousedown",function(e){m=e.clientX,v=e.clientY,I=t(this).position().left,M=t(this).position().top,imgW=t(this).width(),imgH=t(this).height(),F=!0,t(this).on("mousemove",function(e){if(F){var i=e.clientX,n=e.clientY;if(imgW>f){var o=i-m+I;o>0&&(o=0),f-imgW>o&&(o=f-imgW),t(this).css({left:o})}if(imgH>w){var r=n-v+M;r>0&&(r=0),w-imgH>r&&(r=w-imgH),t(this).css({top:r})}}})}).on("mouseup mouseout",function(){F=!1})}p.dblclick(function(){i()})}}),t.extend({viewerSee:function(e){if(!window.applicationCache)return void alert("抱歉您的浏览器版本太低,请更换高版本浏览器或切换到高速模式,建议使用火狐浏览器或者谷歌chrome浏览器");var i=t(e),n=t(e)[0].src;if(!n)return void alert("您图片的路径不正确，请检查");var o,r;o=i[0].naturalWidth,r=i[0].naturalHeight;var a=window.innerWidth,s=window.innerHeight;localStorage.getImgId=JSON.stringify({width:o,height:r,src:n});var h=window.parent||window.top,d=h.document.getElementById("seeMore");t(d).remove(),t("<iframe></iframe").appendTo("body").attr("id","seeMore").attr("src","extendSeeImg/photoSee.html").css({position:"fixed",left:0,top:0,width:a,height:s,overflow:"hidden",zIndex:Math.pow(10,20),"border-radius":"4px"})},initViewerSee:function(){var e=JSON.parse(localStorage.getImgId);t(".photoSee").photoSeeAll(e)}})}(jQuery);